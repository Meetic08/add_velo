scale_x_discrete(breaks = c("janvier", "avril", "aout", "decembre"))
# Créer un facteur ordonné avec les niveaux des jours
data$jour <- factor(data$jour, levels = c("lundi", "mardi", "mercredi", "jeudi", "vendredi", "samedi", "dimanche"))
plot3 <- ggplot(data, aes(x = jour)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Accidents par jour") +
ylab("Nb accidents") +
theme_minimal() +
scale_x_discrete(breaks = c("lundi", "mercredi", "vendredi", "dimanche"))
# Créer un facteur ordonné avec les niveaux les heures
data$Tranche_horaire <- factor(data$Tranche_horaire, levels = c("Matin", "Apres-midi", "Soir", "Nuit", "NA"))
filtered_data <- data[!is.na(data$Tranche_horaire), ]
# Créer le graphique avec les données filtrées
plot4 <- ggplot(filtered_data, aes(x = Tranche_horaire)) +
geom_bar(fill = "skyblue", color = "black") +
ylab("Nb accidents") +
labs(title = "Accidents par tranche horaire") +
theme_minimal()
# Organiser les graphiques en une disposition 2x2
grid.arrange(plot1, plot2, plot3, plot4, ncol = 2)
################## Analyses univariées #################################
data <- read.table("C:/Users/33662/Desktop/add_velo/data/data_clean.txt", sep=",", header = TRUE)
data <- data %>%
mutate(dep = as.numeric(dep))
data <- data %>%
mutate(long = as.numeric(long))
plot1 <- ggplot(data, aes(x = an)) +
geom_histogram(breaks = seq(min(data$an), max(data$an)),
width = 2, fill = "skyblue", color = "black", alpha = 0.7) +
geom_density(alpha = 0.2) +
labs(title = "Accidents par an") +
ylab("Nb accidents") +
theme_minimal()
# Créer un facteur ordonné avec les niveaux des mois
data$mois <- factor(data$mois, levels = c("janvier", "fevrier", "mars", "avril", "mai", "juin", "juillet", "aout", "septembre", "octobre", "novembre", "decembre"))
plot2 <- ggplot(data, aes(x = mois)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Accidents par mois") +
ylab("Nb accidents") +
theme_minimal() +
scale_x_discrete(breaks = c("janvier", "avril", "aout", "decembre"))
# Créer un facteur ordonné avec les niveaux des jours
data$jour <- factor(data$jour, levels = c("lundi", "mardi", "mercredi", "jeudi", "vendredi", "samedi", "dimanche"))
plot3 <- ggplot(data, aes(x = jour)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Accidents par jour") +
ylab("Nb accidents") +
theme_minimal() +
scale_x_discrete(breaks = c("lundi", "mercredi", "vendredi", "dimanche"))
# Créer un facteur ordonné avec les niveaux les heures
data$Tranche_horaire <- factor(data$Tranche_horaire, levels = c("Matin", "Apres-midi", "Soir", "Nuit", "NA"))
filtered_data <- data[!is.na(data$Tranche_horaire), ]
# Créer le graphique avec les données filtrées
plot4 <- ggplot(filtered_data, aes(x = Tranche_horaire)) +
geom_bar(fill = "skyblue", color = "black") +
ylab("Nb accidents") +
labs(title = "Accidents par tranche horaire") +
theme_minimal()
# Organiser les graphiques en une disposition 2x2
grid.arrange(plot1, plot2, plot3, plot4, ncol = 2)
knitr::opts_chunk$set(fig.pos = "H", out.width = "100%", fig.align = "center")
###### Charger les différentes librairies
library(installr)
library(lmtest)
library(tidyverse)
library(data.table)
library(magrittr)
library(DAAG)
library(plotly)
library(tseries)
library(olsrr)
library(car)
library(readr)
library(readxl)
library(dplyr)
library(FactoMineR)
library(factoextra)
library(openxlsx)
library(Factoshiny)
library(gridExtra)
################## Analyses univariées #################################
data <- read.table("C:/Users/33662/Desktop/add_velo/data/data_clean.txt", sep=",", header = TRUE)
data <- data %>%
mutate(dep = as.numeric(dep))
data <- data %>%
mutate(long = as.numeric(long))
plot1 <- ggplot(data, aes(x = an)) +
geom_histogram(breaks = seq(min(data$an), max(data$an)),
width = 2, fill = "skyblue", color = "black", alpha = 0.7) +
geom_density(alpha = 0.2) +
labs(title = "Accidents par an") +
ylab("Nb accidents") +
theme_minimal()
# Créer un facteur ordonné avec les niveaux des mois
data$mois <- factor(data$mois, levels = c("janvier", "fevrier", "mars", "avril", "mai", "juin", "juillet", "aout", "septembre", "octobre", "novembre", "decembre"))
plot2 <- ggplot(data, aes(x = mois)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Accidents par mois") +
ylab("Nb accidents") +
theme_minimal() +
scale_x_discrete(breaks = c("janvier", "avril", "aout", "decembre"))
# Créer un facteur ordonné avec les niveaux des jours
data$jour <- factor(data$jour, levels = c("lundi", "mardi", "mercredi", "jeudi", "vendredi", "samedi", "dimanche"))
plot3 <- ggplot(data, aes(x = jour)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Accidents par jour") +
ylab("Nb accidents") +
theme_minimal() +
scale_x_discrete(breaks = c("lundi", "mercredi", "vendredi", "dimanche"))
# Créer un facteur ordonné avec les niveaux les heures
data$Tranche_horaire <- factor(data$Tranche_horaire, levels = c("Matin", "Apres-midi", "Soir", "Nuit", "NA"))
filtered_data <- data[!is.na(data$Tranche_horaire), ]
# Créer le graphique avec les données filtrées
plot4 <- ggplot(filtered_data, aes(x = Tranche_horaire)) +
geom_bar(fill = "skyblue", color = "black") +
ylab("Nb accidents") +
labs(title = "Accidents par tranche horaire") +
theme_minimal()
# Organiser les graphiques en une disposition 2x2
grid.arrange(plot1, plot2, plot3, plot4, ncol = 2)
######################### PISTE CYCLABLE VELO PARIS ########################################
data_piste_paris <- read.table("C:/Users/33662/Desktop/add_velo/data/data_cycle-piste.csv", sep=",", header = TRUE)
######################### ARRONDISSEMENT AVEC ACC VELO PARIS ########################################
data_arr_paris <- read.table("C:/Users/33662/Desktop/add_velo/data/data_paris_arron-acc.csv", sep=",", header = TRUE)
######################### ACCIDENTS VELO FRANCE #################################
data <- read.table("C:/Users/33662/Desktop/add_velo/data/data_clean.txt", sep=",", header = TRUE)
data <- data %>%
mutate(dep = as.numeric(dep))
data <- data %>%
mutate(long = as.numeric(long))
######################### ARRONDISSEMENT AVEC ACC VELO PARIS ########################################
data_arr_paris <- read.table("C:/Users/33662/Desktop/add_velo/data/data_paris_arron-acc.csv", sep=",", header = TRUE)
############################## ANALYSE PARIS #########################################
data_acc_paris <- filter(data, dep == "75")
data_acc_paris <- select(data_acc_paris, -c(X, dep))
#####################" MERGE data_arr_paris & data_acc_paris avec lat et long comme clés unique ##########
merge_paris <- merge(data_arr_paris, data_acc_paris, by = c("lat", "long"))
view(merge_paris)
######################### ACCIDENTS VELO FRANCE #################################
data <- read.table("C:/Users/33662/Desktop/add_velo/data/data_clean.csv", sep=",", header = TRUE)
######################### ACCIDENTS VELO FRANCE #################################
data <- read.csv("C:/Users/33662/Desktop/add_velo/data/data_clean.csv", sep=",", header = TRUE)
data <- data %>%
mutate(dep = as.numeric(dep))
data <- data %>%
mutate(long = as.numeric(long))
View(data)
############################## ANALYSE PARIS #########################################
data_acc_paris <- filter(data, dep == "75")
data_acc_paris <- select(data_acc_paris, -c(X, dep))
View(data)
colnames(data)
############################## ANALYSE PARIS #########################################
data_acc_paris <- filter(data, dep == "75")
data_acc_paris <- select(data_acc_paris, -c(Unnamed..0, dep))
colnames(data_acc_paris)
unique(data_acc_paris$Region)
#####################" MERGE data_arr_paris & data_acc_paris avec lat et long comme clés unique ##########
merge_paris <- merge(data_arr_paris, data_acc_paris, by = c("lat", "long"))
view(merge_paris)
summary(merge_paris)
##################### Export vers fichier csv ##########################
ma_data_table <- as.data.table(merge_paris)
library(writexl)
write.csv(ma_data_table, "C:/Users/33662/Desktop/add_velo/data/data_paris.csv")
############################# Verif export ################################
library(readr)
data <- read.table("C:/Users/33662/Desktop/add_velo/data/data_paris.csv", sep=",", header = TRUE)
table(data$Arrondissement)
sum(is.na(data$Arrondissement))
data <- read.table("C:/Users/33662/Desktop/add_velo/data/data_clean.csv", sep=",", header = TRUE)
data <- read.csv("C:/Users/33662/Desktop/add_velo/data/data_clean.csv", sep=",", header = TRUE)
data <- data %>%
mutate(dep = as.numeric(dep))
data <- data %>%
mutate(long = as.numeric(long))
plot1 <- ggplot(data, aes(x = an)) +
geom_histogram(breaks = seq(min(data$an), max(data$an)),
width = 2, fill = "skyblue", color = "black", alpha = 0.7) +
geom_density(alpha = 0.2) +
labs(title = "Accidents par an") +
ylab("Nb accidents") +
theme_minimal()
# Créer un facteur ordonné avec les niveaux des mois
data$mois <- factor(data$mois, levels = c("janvier", "fevrier", "mars", "avril", "mai", "juin", "juillet", "aout", "septembre", "octobre", "novembre", "decembre"))
plot2 <- ggplot(data, aes(x = mois)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Accidents par mois") +
ylab("Nb accidents") +
theme_minimal() +
scale_x_discrete(breaks = c("janvier", "avril", "aout", "decembre"))
# Créer un facteur ordonné avec les niveaux des jours
data$jour <- factor(data$jour, levels = c("lundi", "mardi", "mercredi", "jeudi", "vendredi", "samedi", "dimanche"))
plot3 <- ggplot(data, aes(x = jour)) +
geom_bar(fill = "skyblue", color = "black") +
labs(title = "Accidents par jour") +
ylab("Nb accidents") +
theme_minimal() +
scale_x_discrete(breaks = c("lundi", "mercredi", "vendredi", "dimanche"))
# Créer un facteur ordonné avec les niveaux les heures
data$Tranche_horaire <- factor(data$Tranche_horaire, levels = c("Matin", "Apres-midi", "Soir", "Nuit", "NA"))
filtered_data <- data[!is.na(data$Tranche_horaire), ]
# Créer le graphique avec les données filtrées
plot4 <- ggplot(filtered_data, aes(x = Tranche_horaire)) +
geom_bar(fill = "skyblue", color = "black") +
ylab("Nb accidents") +
labs(title = "Accidents par tranche horaire") +
theme_minimal()
# Organiser les graphiques en une disposition 2x2
grid.arrange(plot1, plot2, plot3, plot4, ncol = 2)
############################# PROJET ADD analyse -- Léo GABET ###################################
############################### Charger les différentes librairies ######################################
library(installr)
library(lmtest)
library(tidyverse)
library(data.table)
library(magrittr)
library(DAAG)
library(plotly)
library(tseries)
library(olsrr)
library(car)
library(readr)
library(readxl)
library(dplyr)
library(FactoMineR)
library(factoextra)
library(openxlsx)
library(Factoshiny)
library(gridExtra)
######################### ACCIDENTS VELO FRANCE #################################
data <- read.csv("C:/Users/33662/Desktop/add_velo/data/data_clean.csv", sep=",", header = TRUE)
data <- data %>%
mutate(dep = as.numeric(dep))
data <- data %>%
mutate(long = as.numeric(long))
# Définir les couleurs pour chaque groupe de variables
col.var <- c("blue", "blue","blue","blue","blue","blue","blue","blue", "blue","blue","blue","green","red")
# Effectuer l'Analyse des Correspondances Multiples (ACM)
resultats_acm <- MCA(baseACM, graph = FALSE)
# Plot avec couleurs différentes pour les variables et sans noms d'individus
plot.MCA(resultats_acm, title = "Graphe de l'ACM", invisible = "ind", col.var = col.var)
baseACM <- data.frame(Meteo = data$Meteo, Consequence = data$Consequence, Contexte = data$Contexte)
# Effectuer l'Analyse des Correspondances Multiples (ACM)
resultats_acm <- MCA(baseACM, graph = FALSE)
# Afficher les résultats de l'ACM
summary(resultats_acm)
# Visualiser les résultats (graphiques)
plot.MCA(resultats_acm, cex = 0.5, col.var = "black")
# Définir les couleurs pour chaque groupe de variables
col.var <- c("blue", "blue","blue","blue","blue","blue","blue","blue", "blue","blue","blue","green","red")
# Effectuer l'Analyse des Correspondances Multiples (ACM)
resultats_acm <- MCA(baseACM, graph = FALSE)
# Plot avec couleurs différentes pour les variables et sans noms d'individus
plot.MCA(resultats_acm, title = "Graphe de l'ACM", invisible = "ind", col.var = col.var)
# Définir les couleurs pour chaque groupe de variables
col.var <- c("blue", "blue","blue","blue","blue","blue","blue","blue","blue","blue","blue"
,"red","red","red","red")
# Effectuer l'Analyse des Correspondances Multiples (ACM)
resultats_acm <- MCA(baseACM, graph = FALSE)
# Plot avec couleurs différentes pour les variables et sans noms d'individus
plot.MCA(resultats_acm, title = "Graphe de l'ACM", invisible = "ind", col.var = col.var)
# Définir les couleurs pour chaque groupe de variables
col.var <- c("blue", "blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue"
,"red","red","red","red")
# Effectuer l'Analyse des Correspondances Multiples (ACM)
resultats_acm <- MCA(baseACM, graph = FALSE)
# Plot avec couleurs différentes pour les variables et sans noms d'individus
plot.MCA(resultats_acm, title = "Graphe de l'ACM", invisible = "ind", col.var = col.var)
Factoshiny(data)
Factoshiny(data)
Factoshiny(data)
Factoshiny(data)
##### TOP 10 ####
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(16,17),graph=FALSE)
plot.MCA(res.MCA, choix='var',invisible=c('quali.sup','quanti.sup'),title="Graphe des variables",cex=0.65,cex.main=0.65,cex.axis=0.65)
plot.MCA(res.MCA,invisible= 'ind',selectMod= 'contrib  10 ',title="Graphe de l'ACM",cex=0.9,cex.main=0.9,cex.axis=0.9,label =c('var','quali.sup'))
plot.MCA(res.MCA, choix='quanti.sup',title="Variables quantitatives suplémentaires")
plot.MCA(res.MCA,invisible= 'ind',selectMod= 'contrib  10 ',title="Graphe de l'ACM",cex=0.9,cex.main=0.9,cex.axis=0.9,label =c('var','quali.sup'))
plot.MCA(res.MCA,invisible= 'ind',selectMod= 'contrib  10 ',title="Graphe de l'ACM",cex=0.7,cex.main=0.9,cex.axis=0.9,label =c('var','quali.sup'))
plot.MCA(res.MCA,invisible= 'ind',selectMod= 'contrib  10 ',title="Graphe de l'ACM",cex=0.5,cex.main=0.9,cex.axis=0.9,label =c('var','quali.sup'))
plot.MCA(res.MCA,invisible= 'ind',selectMod= 'contrib  10 ',title="Graphe de l'ACM",cex=0.3,cex.main=0.9,cex.axis=0.9,label =c('var','quali.sup'))
plot.MCA(res.MCA,invisible= 'ind',selectMod= 'contrib  10 ',title="Graphe de l'ACM",cex=0.5,cex.main=0.9,cex.axis=0.9,label =c('var','quali.sup'))
##### modalite #########
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),graph=FALSE)
plot.MCA(res.MCA, choix='var',invisible=c('quali.sup','quanti.sup'),title="Graphe des variables",cex=0.85,cex.main=0.85,cex.axis=0.85)
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(3,4,5,9,10,11,12,14,15,16,17,18,19,20,22,25,26,27,28,29),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables",col.var=c(1,2,3))
plotellipses(res.MCA,keepvar=21,title="Graphe de l'ACM",cex=1.45,cex.main=1.45,cex.axis=1.45,label ='quali')
plotellipses(res.MCA,keepvar=21,title="Graphe de l'ACM",cex=1.45,cex.main=1.45,cex.axis=1.45,label ='quali')
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(3,4,5,9,10,11,12,14,15,16,17,18,19,20,22,25,26,27,28,29),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables",col.var=c(1,2,3))
plot.MCA(res.MCA,invisible= c('ind','quali.sup'),habillage='contrib',title="Graphe de l'ACM",label =c('var'))
# Afficher les résultats de l'ACM
summary(resultats_acm)
# Effectuer l'Analyse des Correspondances Multiples (ACM)
resultats_acm <- MCA(baseACM, graph = FALSE)
# Effectuer l'Analyse des Correspondances Multiples (ACM)
resultats_acm <- MCA(baseACM, graph = TRUE)
# Effectuer l'Analyse des Correspondances Multiples (ACM)
resultats_acm <- MCA(data, graph = TRUE)
##### TOP 10 ####
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(16,17),graph=FALSE)
plot.MCA(res.MCA, choix='var',invisible=c('quali.sup','quanti.sup'),title="Graphe des variables",cex=0.65,cex.main=0.65,cex.axis=0.65)
plot.MCA(res.MCA,invisible= 'ind',selectMod= 'contrib  10 ',title="Graphe de l'ACM",cex=0.5,cex.main=0.9,cex.axis=0.9,label =c('var','quali.sup'))
plot.MCA(res.MCA, choix='var',invisible=c('quali.sup','quanti.sup'),title="Graphe des variables",cex=0.65,cex.main=0.65,cex.axis=0.65)
##### modalite #########
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),graph=FALSE)
plot.MCA(res.MCA, choix='var',invisible=c('quali.sup','quanti.sup'),title="Graphe des variables",cex=0.85,cex.main=0.85,cex.axis=0.85)
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(3,4,5,9,10,11,12,14,15,16,17,18,19,20,22,25,26,27,28,29),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables",col.var=c(1,2,3))
plot.MCA(res.MCA,invisible= c('ind','quali.sup'),col.var=c(1,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3),col.quali.sup=c(4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,7,7,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,18,18,19,19,20,20,20,20,20,20,20,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23),title="Graphe de l'ACM",label =c('var'))
plot.MCA(res.MCA, choix='quanti.sup',title="Variables quantitatives suplémentaires")
Factoshiny(data)
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(3,4,5,9,10,11,12,14,15,16,17,18,19,20,22,25,26,27,28,29),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables",col.var=c(1,2,3))
plot.MCA(res.MCA,invisible= c('ind','quali.sup'),habillage='contrib',title="Graphe de l'ACM",label =c('var'))
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(3,4,5,9,10,11,12,14,15,16,17,18,19,20,22,25,26,27,28,29),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables",col.var=c(1,2,3))
plotellipses(res.MCA,keepvar=21,title="Graphe de l'ACM",cex=1.45,cex.main=1.45,cex.axis=1.45,label ='quali')
##### modalite #########
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),graph=FALSE)
plot.MCA(res.MCA, choix='var',invisible=c('quali.sup','quanti.sup'),title="Graphe des variables",cex=0.85,cex.main=0.85,cex.axis=0.85)
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(3,4,5,9,10,11,12,14,15,16,17,18,19,20,22,25,26,27,28,29),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables",col.var=c(1,2,3))
plotellipses(res.MCA,keepvar=21,title="Graphe de l'ACM",cex=1.45,cex.main=1.45,cex.axis=1.45,label ='quali')
summary(res.MCA)
##### modalite #########
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),graph=FALSE)
plot.MCA(res.MCA, choix='var',invisible=c('quali.sup','quanti.sup'),title="Graphe des variables",cex=0.85,cex.main=0.85,cex.axis=0.85)
summary(res.MCA)
summary(res.MCA)
##### TOP 10 ####
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(16,17),graph=FALSE)
plot.MCA(res.MCA, choix='var',invisible=c('quali.sup','quanti.sup'),title="Graphe des variables",cex=0.65,cex.main=0.65,cex.axis=0.65)
plot.MCA(res.MCA,invisible= 'ind',selectMod= 'contrib  10 ',title="Graphe de l'ACM",cex=0.5,cex.main=0.9,cex.axis=0.9,label =c('var','quali.sup'))
plot.MCA(res.MCA, choix='var',invisible=c('quali.sup','quanti.sup'),title="Graphe des variables",cex=0.65,cex.main=0.65,cex.axis=0.65)
plot.MCA(res.MCA,invisible= 'ind',selectMod= 'contrib  10 ',title="Graphe de l'ACM",cex=0.6,cex.main=0.9,cex.axis=0.9,label =c('var','quali.sup'))
plot.MCA(res.MCA,invisible= 'ind',selectMod= 'contrib  10 ',title="Graphe de l'ACM",cex=0.6,cex.main=0.9,cex.axis=0.9,label =c('var','quali.sup'))
summary(res.MCA)
plot.MCA(res.MCA, choix='var',invisible=c('quali.sup','quanti.sup'),title="Graphe des variables",cex=0.65,cex.main=0.65,cex.axis=0.65)
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(3,4,5,9,10,11,12,14,15,16,17,18,19,20,22,25,26,27,28,29),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables",col.var=c(1,2,3))
plot.MCA(res.MCA,invisible= c('ind','quali.sup'),col.var=c(1,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3),col.quali.sup=c(4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,7,7,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,18,18,19,19,20,20,20,20,20,20,20,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23),title="Graphe de l'ACM",label =c('var'))
plot.MCA(res.MCA, choix='quanti.sup',title="Variables quantitatives suplémentaires")
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(3,4,5,9,10,11,12,14,15,16,17,18,19,20,22,25,26,27,28,29),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables",col.var=c(1,2,3))
plot.MCA(res.MCA,invisible= c('ind','quali.sup'),habillage='contrib',title="Graphe de l'ACM",label =c('var'))
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(3,4,5,9,10,11,12,14,15,16,17,18,19,20,22,25,26,27,28,29),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables",col.var=c(1,2,3))
plotellipses(res.MCA,keepvar=21,title="Graphe de l'ACM",cex=1.45,cex.main=1.45,cex.axis=1.45,label ='quali')
summary(res.MCA)
Factoshiny(data)
## consequence ##
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(16,17),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=1,cex.axis=0.7,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=1,cex.axis=1,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=1,cex.axis=2,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,cex.grid = 1.2,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,cex.grid = 2,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,cex.grid = 0.2,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,autolab=yes,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,autoLab="yes",label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,cex.lab=1,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,cex.lab=0.8,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,cex.lab=0.2,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,cex.lab.mod=1.5,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="purple")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="orange")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="grey")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="darkgrey")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="dark")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="black")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="yellow")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="darkyellow")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="skyblue")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="darkblue")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="darkorange")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,cex.lab.mod=3,label =c('var'), col.var="purple")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="purple",
xlim = c(-1, 1), ylim = c(-1, 1))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="purple",
xlim = c(-1.5, 1.5), ylim = c(-1, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="purple",
xlim = c(-1, 1.5), ylim = c(-1, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=30,title="Graphe de l'ACM",cex=0.4,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="purple",
xlim = c(-1, 1.5), ylim = c(-1, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.7,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="purple",
xlim = c(-1, 1.5), ylim = c(-1, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="purple",
xlim = c(-1, 1.5), ylim = c(-1, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="orange",
xlim = c(-1, 1.5), ylim = c(-1, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="darkorange",
xlim = c(-1, 1.5), ylim = c(-1, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="skyblue",
xlim = c(-1, 1.5), ylim = c(-1, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="darkgrey",
xlim = c(-1, 1.5), ylim = c(-1, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="grey",
xlim = c(-1, 1.5), ylim = c(-1, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="grey",
xlim = c(-1, 1.5), ylim = c(-0.75, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="black",
xlim = c(-1, 1.5), ylim = c(-0.75, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="pink",
xlim = c(-1, 1.5), ylim = c(-0.75, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="brown",
xlim = c(-1, 1.5), ylim = c(-0.75, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="cyan",
xlim = c(-1, 1.5), ylim = c(-0.75, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="cyan",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="magenta",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.5))
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="magenta",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.5), autoLab = "y")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="magenta",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="cyan",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="blue",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="orange",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="darkorange",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="orange",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="darkorange",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="magenta",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="cyan",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="darkcyan",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
knitr::opts_chunk$set(fig.pos = "H", out.width = "80%", fig.align = "center")
###### Charger les différentes librairies
library(installr)
library(lmtest)
library(tidyverse)
library(data.table)
library(magrittr)
library(DAAG)
library(plotly)
library(tseries)
library(olsrr)
library(car)
library(readr)
library(readxl)
library(dplyr)
library(FactoMineR)
library(factoextra)
library(openxlsx)
library(Factoshiny)
library(gridExtra)
library(cowplot)
library(stringr)
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(16,17),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="darkcyan",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(16,17),graph=FALSE)
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=0.5,cex.main=0.7,cex.axis=0.7,
cex.lab.mod=3,label =c('var'), col.var="darkcyan",
xlim = c(-1.1, 1.5), ylim = c(-0.75, 1.40), autoLab = "y")
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(3,4,5,9,10,11,12,14,15,16,17,18,19,20,22,25,26,27,28,29),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables",col.var=c(1,2,3))
plot.MCA(res.MCA,invisible= c('ind','quali.sup'),col.var=c(1,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3),col.quali.sup=c(4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,7,7,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,18,18,19,19,20,20,20,20,20,20,20,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23),title="Graphe de l'ACM",label =c('var'))
plot.MCA(res.MCA, choix='quanti.sup',title="Variables quantitatives suplémentaires")
plot.MCA(res.MCA,invisible= c('ind','quali.sup'),col.var=c(1,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3),col.quali.sup=c(4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,7,7,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,18,18,19,19,20,20,20,20,20,20,20,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23),title="Graphe de l'ACM",label =c('var'))
Factoshiny(data)
## LAST
res.MCA<-MCA(data,quanti.sup=c(1,2,6,7,8,23),quali.sup=c(3,4,5,9,10,11,12,13,14,15,16,17,18,19,20,21,22,26,27,28),graph=FALSE)
plot.MCA(res.MCA, choix='var',title="Graphe des variables")
plot.MCA(res.MCA,invisible= 'quali.sup',habillage=21,title="Graphe de l'ACM",cex=1.15,cex.main=1.15,cex.axis=1.15,label =c('var'))
